-- ============================================================================
-- SQL скрипт для добавления роли 'main_organizer' в таблицу profiles
-- ============================================================================
-- ИНСТРУКЦИЯ:
-- Выполните этот скрипт в Supabase SQL Editor
-- ============================================================================

-- Шаг 1: Удаляем старый constraint
ALTER TABLE profiles DROP CONSTRAINT IF EXISTS profiles_role_check;

-- Шаг 2: Создаем новый constraint с поддержкой роли main_organizer
ALTER TABLE profiles ADD CONSTRAINT profiles_role_check 
  CHECK (role IN ('client', 'organizer', 'main_organizer'));

-- ============================================================================
-- Проверка результата (опционально)
-- Раскомментируйте запрос ниже, чтобы проверить, что constraint обновлен:
-- ============================================================================
-- SELECT 
--   conname AS constraint_name,
--   pg_get_constraintdef(oid) AS constraint_definition
-- FROM pg_constraint
-- WHERE conrelid = 'profiles'::regclass
--   AND conname = 'profiles_role_check';

-- ============================================================================
-- ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ:
-- ============================================================================
-- 
-- После выполнения этого скрипта вы сможете:
-- 1. Создавать пользователей с ролью 'main_organizer' в таблице profiles
-- 2. Использовать эту роль для главных организаторов с расширенными правами
-- ============================================================================



